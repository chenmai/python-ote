'''
Created on 2016年6月4日

@author: hasee
'''
import mysql.connector



# 打开数据库连接
db = mysql.connector.connect(host='localhost', port='3306', user='root', password="123456", database="test", use_unicode=True);

# 使用 cursor() 方法创建一个游标对象 cursor
cursor = db.cursor()


# SQL 插入语句
# sql = """INSERT INTO EMPLOYEE(FIRST_NAME,
#          LAST_NAME, AGE, SEX, INCOME)
#          VALUES ('Mac', 'Mohan', 20, 'M', 2000)"""

user_id = "test123"
password = "password"

con.execute('insert into Login values("%s", "%s")' % \
             (user_id, password))

try:
   # 执行sql语句
   cursor.execute(sql)
   # 提交到数据库执行
   db.commit()
except:
   # 如果发生错误则回滚
   db.rollback()

# 关闭数据库连接
db.close()